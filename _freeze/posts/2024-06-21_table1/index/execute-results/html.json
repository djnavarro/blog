{
  "hash": "aac88c79f94a86fc7fedc4401d5f17af",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Making tables in R with table1\"\ndescription: \"A pretty reckless dive into a package that hits the sweet spot for me\"\ndate: \"2024-06-21\"\ncategories: [\"R\"]\nformat: \n  html:\n    css: style-tweaks.css\n--- \n\n\n<!--------------- my typical setup ----------------->\n\n\n\n\n\n<!--------------- post begins here ----------------->\n\n> I'll never be good enough <br>\n> You make me wanna die <br>\n> And everything you love will burn up in the light <br>\n> And every time I look inside your eyes <br>\n> You make me wanna die <br>\n> &nbsp; &nbsp; - [*The Pretty Reckless*](https://www.youtube.com/watch?v=txBfhpm1jI0)\n\nIt's no secret that my health hasn't been so great these last few months. Nothing life-threatening, I hasten to add, but severe enough that I've spent a depressing amount of 2024 in bed, and not in the fun way. I'm fortunate enough to have a remote job, and the workload this year hasn't been as demanding as it was last year. I've been able to manage, yes,^[It always strikes me as a bitter failure of public policy that when someone falls sick, their first thought is *always* something along the lines of \"can I still work?\" Very few people actually love their jobs so much that they want to work through a serious illness, but the fear that the company will discard you the moment something bad happens is built into our society at a low level. If you're not dead you work. Because capitalism.] but it has been rough. I've necessarily been focusing what little energy I've had on my kids and on my day to day work. I've had no bandwidth at all to write, or make art, or learn new things. A sorry state of affairs, and one that sucks much of the joy out of life.\n\nHappily, things have started to turn around in recent weeks. I've had a little more energy, I've been able to work from my desk rather than my bed, and while the artistic impulse hasn't come back yet I've started to write once more. \n\nThe [table1](https://benjaminrich.github.io/table1/) package by Benjamin Rich. Package source code is on [github](https://github.com/benjaminrich/table1), and the [package vignette](https://benjaminrich.github.io/table1/vignettes/table1-examples.html) provides a lot of useful detail that you can't necessarily find by browsing the help files.\n\n\n![](./make-me-wanna-die.jpg)\n\n## Getting started\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(palmerpenguins)\nlibrary(table1)\nlibrary(dplyr)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 344 × 8\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year\n   <fct>   <fct>              <dbl>         <dbl>             <int>       <int> <fct>  <int>\n 1 Adelie  Torgersen           39.1          18.7               181        3750 male    2007\n 2 Adelie  Torgersen           39.5          17.4               186        3800 female  2007\n 3 Adelie  Torgersen           40.3          18                 195        3250 female  2007\n 4 Adelie  Torgersen           NA            NA                  NA          NA <NA>    2007\n 5 Adelie  Torgersen           36.7          19.3               193        3450 female  2007\n 6 Adelie  Torgersen           39.3          20.6               190        3650 male    2007\n 7 Adelie  Torgersen           38.9          17.8               181        3625 female  2007\n 8 Adelie  Torgersen           39.2          19.6               195        4675 male    2007\n 9 Adelie  Torgersen           34.1          18.1               193        3475 <NA>    2007\n10 Adelie  Torgersen           42            20.2               190        4250 <NA>    2007\n# ℹ 334 more rows\n```\n\n\n:::\n:::\n\n\n\nBasic usage:^[The output of a call to `table1()` has S3 class \"table1\", and internally specifies an HTML table (more on that later). When printed in a quarto or R markdown document like this one, in the normal course of events the `table1:::knit_print.table()` method is called, in which case the table1 object is coerced to a data frame and the end result looks the same as a data frame would look when `knitr::kable()` is called. However, this is slightly different to how the table looks if you call it interactively in an R session where the S3 method called is `table1:::print.table1()`. Because I want the output in this post to look as close as possible to the typical output when calling `table1()` in a regular R session, I've set `results = \"asis\"` for all my code chunks in this document, thereby ending up with tables that look the same as the ones you see interactively in the R session.]\n\n\n\n```{.r .cell-code}\ntable1(~ island + bill_length_mm | species, penguins)\n```\n\n```{=html}\n<div class=\"Rtable1\"><table class=\"Rtable1\">\n<thead>\n<tr>\n<th class='rowlabel firstrow lastrow'></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Adelie<br><span class='stratn'>(N=152)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Chinstrap<br><span class='stratn'>(N=68)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gentoo<br><span class='stratn'>(N=124)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Overall<br><span class='stratn'>(N=344)</span></span></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow'>island</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Biscoe</td>\n<td>44 (28.9%)</td>\n<td>0 (0%)</td>\n<td>124 (100%)</td>\n<td>168 (48.8%)</td>\n</tr>\n<tr>\n<td class='rowlabel'>Dream</td>\n<td>56 (36.8%)</td>\n<td>68 (100%)</td>\n<td>0 (0%)</td>\n<td>124 (36.0%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Torgersen</td>\n<td class='lastrow'>52 (34.2%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>52 (15.1%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>bill_length_mm</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>38.8 (2.66)</td>\n<td>48.8 (3.34)</td>\n<td>47.5 (3.08)</td>\n<td>43.9 (5.46)</td>\n</tr>\n<tr>\n<td class='rowlabel'>Median [Min, Max]</td>\n<td>38.8 [32.1, 46.0]</td>\n<td>49.6 [40.9, 58.0]</td>\n<td>47.3 [40.9, 59.6]</td>\n<td>44.5 [32.1, 59.6]</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>1 (0.7%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (0.8%)</td>\n<td class='lastrow'>2 (0.6%)</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n\n\n<br>\n\nThe stratification variable (i.e. `species`) isn't actually necessary to create a table, and if you wanted you could produce a table using a formula like `~ island + bill_length_mm`. In practice, however, I've found that I never do this: almost every table I've created in real life has a stratification variable.\n\n## Applying labels\n\nThe table I produced above immediately illustrates the first problem a data analyst has to grapple with when using the table1 package: variable labels. In most respects this \"off the shelf\" table is surprisingly good: it's almost good enough to use. But there's one big eyesore: the raw variable names `island` and `bill_length_mm` appear as row labels in the output. These are both excellent variable names for programming, but they're not very nice when exposed in a table. To fix this, we can use the `label()` function supplied by the table1 package to associate each of these variables with a pretty, human-readable label:^[The table1 package also supports units as a separate piece of metadata via the `units()` function, but I have to admit I never really use that one.]\n\n\n\n```{.r .cell-code}\nlabel(penguins$island) <- \"Island\"\nlabel(penguins$bill_length_mm) <- \"Bill Length (mm)\"\n\ntable1(~ island + bill_length_mm | species, penguins)\n```\n\n```{=html}\n<div class=\"Rtable1\"><table class=\"Rtable1\">\n<thead>\n<tr>\n<th class='rowlabel firstrow lastrow'></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Adelie<br><span class='stratn'>(N=152)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Chinstrap<br><span class='stratn'>(N=68)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gentoo<br><span class='stratn'>(N=124)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Overall<br><span class='stratn'>(N=344)</span></span></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow'>Island</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Biscoe</td>\n<td>44 (28.9%)</td>\n<td>0 (0%)</td>\n<td>124 (100%)</td>\n<td>168 (48.8%)</td>\n</tr>\n<tr>\n<td class='rowlabel'>Dream</td>\n<td>56 (36.8%)</td>\n<td>68 (100%)</td>\n<td>0 (0%)</td>\n<td>124 (36.0%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Torgersen</td>\n<td class='lastrow'>52 (34.2%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>52 (15.1%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Bill Length (mm)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>38.8 (2.66)</td>\n<td>48.8 (3.34)</td>\n<td>47.5 (3.08)</td>\n<td>43.9 (5.46)</td>\n</tr>\n<tr>\n<td class='rowlabel'>Median [Min, Max]</td>\n<td>38.8 [32.1, 46.0]</td>\n<td>49.6 [40.9, 58.0]</td>\n<td>47.3 [40.9, 59.6]</td>\n<td>44.5 [32.1, 59.6]</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>1 (0.7%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (0.8%)</td>\n<td class='lastrow'>2 (0.6%)</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n\n\n<br>\n\nTo understand what's really going on here, it's helpful to recognise that the `label()` function is *purely* a convenience function. All it's really doing is setting the \"label\" metadata attribute for the relevant object. If you really wanted to, you could do exactly the same thing in base R via the `attr()` function:\n\n\n\n```{.r .cell-code}\nattr(penguins$bill_depth_mm, \"label\") <- \"Bill Depth (mm)\"\n\ntable1(~ bill_depth_mm | species, penguins)\n```\n\n```{=html}\n<div class=\"Rtable1\"><table class=\"Rtable1\">\n<thead>\n<tr>\n<th class='rowlabel firstrow lastrow'></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Adelie<br><span class='stratn'>(N=152)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Chinstrap<br><span class='stratn'>(N=68)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gentoo<br><span class='stratn'>(N=124)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Overall<br><span class='stratn'>(N=344)</span></span></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow'>Bill Depth (mm)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>18.3 (1.22)</td>\n<td>18.4 (1.14)</td>\n<td>15.0 (0.981)</td>\n<td>17.2 (1.97)</td>\n</tr>\n<tr>\n<td class='rowlabel'>Median [Min, Max]</td>\n<td>18.4 [15.5, 21.5]</td>\n<td>18.5 [16.4, 20.8]</td>\n<td>15.0 [13.1, 17.3]</td>\n<td>17.3 [13.1, 21.5]</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>1 (0.7%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (0.8%)</td>\n<td class='lastrow'>2 (0.6%)</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n\n\n<br>\n\nThat being said, I am slowly coming to like the `setLabel()` convenience function that table1 provides rather than using `label()` or `attr()`. The `setLabel()` function has the nice property that it returns the labelled object itself and so it plays very nicely with a dplyr workflow. If you have a data frame with several variables that need to be labelled, you can use `mutate()` and `setLabel()` to apply all the labels in one step, like this:\n\n\n\n```{.r .cell-code}\npenguins <- penguins |> \n  mutate(\n    flipper_length_mm = setLabel(flipper_length_mm, \"Flipper Length (mm)\"),\n    body_mass_g = setLabel(body_mass_g, \"Body Mass (g)\"),\n    sex = setLabel(sex, \"Sex\"),\n    year = setLabel(year, \"Year\")\n  )\n\ntable1(~ flipper_length_mm + body_mass_g + sex + year | species, penguins)\n```\n\n```{=html}\n<div class=\"Rtable1\"><table class=\"Rtable1\">\n<thead>\n<tr>\n<th class='rowlabel firstrow lastrow'></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Adelie<br><span class='stratn'>(N=152)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Chinstrap<br><span class='stratn'>(N=68)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gentoo<br><span class='stratn'>(N=124)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Overall<br><span class='stratn'>(N=344)</span></span></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow'>Flipper Length (mm)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>190 (6.54)</td>\n<td>196 (7.13)</td>\n<td>217 (6.48)</td>\n<td>201 (14.1)</td>\n</tr>\n<tr>\n<td class='rowlabel'>Median [Min, Max]</td>\n<td>190 [172, 210]</td>\n<td>196 [178, 212]</td>\n<td>216 [203, 231]</td>\n<td>197 [172, 231]</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>1 (0.7%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (0.8%)</td>\n<td class='lastrow'>2 (0.6%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Body Mass (g)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>3700 (459)</td>\n<td>3730 (384)</td>\n<td>5080 (504)</td>\n<td>4200 (802)</td>\n</tr>\n<tr>\n<td class='rowlabel'>Median [Min, Max]</td>\n<td>3700 [2850, 4780]</td>\n<td>3700 [2700, 4800]</td>\n<td>5000 [3950, 6300]</td>\n<td>4050 [2700, 6300]</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>1 (0.7%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (0.8%)</td>\n<td class='lastrow'>2 (0.6%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Sex</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>female</td>\n<td>73 (48.0%)</td>\n<td>34 (50.0%)</td>\n<td>58 (46.8%)</td>\n<td>165 (48.0%)</td>\n</tr>\n<tr>\n<td class='rowlabel'>male</td>\n<td>73 (48.0%)</td>\n<td>34 (50.0%)</td>\n<td>61 (49.2%)</td>\n<td>168 (48.8%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>6 (3.9%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>5 (4.0%)</td>\n<td class='lastrow'>11 (3.2%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Year</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>2010 (0.822)</td>\n<td>2010 (0.863)</td>\n<td>2010 (0.792)</td>\n<td>2010 (0.818)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Median [Min, Max]</td>\n<td class='lastrow'>2010 [2010, 2010]</td>\n<td class='lastrow'>2010 [2010, 2010]</td>\n<td class='lastrow'>2010 [2010, 2010]</td>\n<td class='lastrow'>2010 [2010, 2010]</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n\n\n<br>\n\n\n![](my-medicine.jpg)\n\n## Customing cell content\n\n> Somebody mixed my medicine <br>\n> Somebody's in my head again <br>\n> Well, I'll drink what you leak and I'll smoke what you sigh <br>\n> See across the room with a look in your eye <br>\n> &nbsp; &nbsp; --[*The Pretty Reckless*](https://www.youtube.com/watch?v=cJMSDlWlfMM)\n\nOne thing I really like about the table1 package is that it supplies very sensible defaults for tables of descriptive statistics: continuous variables are summarised not only via means and standard deviations, but you also get the medians, ranges, and missing data summaries. Categorical variables are summarised with counts and percentages, and again you get a missing data summary. Very often this is exactly the summary you want, and no customisation at all is required.\n\nInevitably, though, every data analyst comes across as situation that requires a different collection of summary statistics. At that point, you need to dive a little deeper and understand the syntax table1 uses to modify the summaries that it produces. \n\n### Using abbreviated codes\n\nThe table1 package has a very practical and flexible mechanism for customising the descriptive statistics that it produces, but one that needs a bit of unpacking to understand. If you really want to do so, you can write an entire \"rendering\" function from scratch that affords very fine grained control over the output (more on that later!) but most of the time you don't actually want to go to all that effort. In most situations, all you *really* want to do is swap out one widely-used descriptive statistic for a different widely-used descriptive statistic. It would be no fun for the analyst if they had to write an entire rendering function from scratch just to switch from reporting arithmetic means to reporting geometric means. To that end, table1 provides a compact syntax using \"abbreviated codes\" that covers a lot of common use cases.\n\nAs a concrete example, let's consider the task I described above: reporting geometric means and standard deviations. This is a very common task in pharmacometrics because a lot of observed data are approximately log-normal in distribution, and in my everyday work I find I have to do this a lot. Luckily for me, the table1 package recognises the strings `\"GMEAN\"` and `\"GSD\"` as abbreviated codes, and internally will replace them with function calls that compute the geometric mean and geometric standard deviation. To define a custom render that produces these two statistics, all I have to do is define a named vector like this one:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrender_geometric <- c(\n  \"Geometric mean\" = \"GMEAN\", \n  \"Geometric SD\" = \"GSD\"\n)\n```\n:::\n\n\nIn this compressed syntax, the names define the row labels that will be printed in the output table (e.g., `\"Geometric mean\"` becomes a row label), and the values are interpreted using the abbreviated code (e.g., the `\"GMEAN\"` string is replaced by the value of the geometric mean). To apply this custom render to my table only to the continuous variables in the summary table, all I have to do is include `render.continuous = render_geometric` in the call to `table1()`:\n\n\n\n```{.r .cell-code}\ntable1(\n  x = ~ flipper_length_mm + body_mass_g + sex + year | species, \n  data = penguins, \n  render.continuous = render_geometric\n)\n```\n\n```{=html}\n<div class=\"Rtable1\"><table class=\"Rtable1\">\n<thead>\n<tr>\n<th class='rowlabel firstrow lastrow'></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Adelie<br><span class='stratn'>(N=152)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Chinstrap<br><span class='stratn'>(N=68)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gentoo<br><span class='stratn'>(N=124)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Overall<br><span class='stratn'>(N=344)</span></span></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow'>Flipper Length (mm)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Geometric mean</td>\n<td>190</td>\n<td>196</td>\n<td>217</td>\n<td>200</td>\n</tr>\n<tr>\n<td class='rowlabel'>Geometric SD</td>\n<td>1.04</td>\n<td>1.04</td>\n<td>1.03</td>\n<td>1.07</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>1 (0.7%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (0.8%)</td>\n<td class='lastrow'>2 (0.6%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Body Mass (g)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Geometric mean</td>\n<td>3670</td>\n<td>3710</td>\n<td>5050</td>\n<td>4130</td>\n</tr>\n<tr>\n<td class='rowlabel'>Geometric SD</td>\n<td>1.13</td>\n<td>1.11</td>\n<td>1.11</td>\n<td>1.21</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>1 (0.7%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (0.8%)</td>\n<td class='lastrow'>2 (0.6%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Sex</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>female</td>\n<td>73 (48.0%)</td>\n<td>34 (50.0%)</td>\n<td>58 (46.8%)</td>\n<td>165 (48.0%)</td>\n</tr>\n<tr>\n<td class='rowlabel'>male</td>\n<td>73 (48.0%)</td>\n<td>34 (50.0%)</td>\n<td>61 (49.2%)</td>\n<td>168 (48.8%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>6 (3.9%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>5 (4.0%)</td>\n<td class='lastrow'>11 (3.2%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Year</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Geometric mean</td>\n<td>2010</td>\n<td>2010</td>\n<td>2010</td>\n<td>2010</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Geometric SD</td>\n<td class='lastrow'>1.00</td>\n<td class='lastrow'>1.00</td>\n<td class='lastrow'>1.00</td>\n<td class='lastrow'>1.00</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n\n\n<br>\n\nAs you can see from the output, the custom render has been applied to the two continuous variables `flipper_length_mm` and `body_mass_g` but not the categorical variables `sex` and `year`, just as you'd expect given that the argument I specified is called `render.continuous`. However, there are two features that might be a little surprising:\n\n- The missing data summary for the continuous variables is unaffected\n- If you look at the documentation for `table1()` you'll notice it has a `render` argument but not a `render.continuous` argument\n\nI'll unpack both of those things later in the blog post, but I wanted to mention them now because these things confused me a little when I first started using table1. For now, let's just accept that it works and move on.\n\nThe table1 package comes equipped with quite a few of these abbreviated codes, which makes life considerably easier. For instance if we needed to compute the 10th, 50th, and 90th percentiles of each continuous variable, we could use the `\"q10\"`, `\"q50\"`, and `\"q90\"` keywords, like so:\n\n\n\n```{.r .cell-code}\ntable1(\n  x = ~ flipper_length_mm + body_mass_g + sex | species, \n  data = penguins, \n  render.continuous = c(\n    \"10th percentile\" = \"q10\", \n    \"50th percentile\" = \"q50\",\n    \"90th percentile\" = \"q90\"\n  )\n)\n```\n\n```{=html}\n<div class=\"Rtable1\"><table class=\"Rtable1\">\n<thead>\n<tr>\n<th class='rowlabel firstrow lastrow'></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Adelie<br><span class='stratn'>(N=152)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Chinstrap<br><span class='stratn'>(N=68)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gentoo<br><span class='stratn'>(N=124)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Overall<br><span class='stratn'>(N=344)</span></span></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow'>Flipper Length (mm)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>10th percentile</td>\n<td>181</td>\n<td>187</td>\n<td>209</td>\n<td>185</td>\n</tr>\n<tr>\n<td class='rowlabel'>50th percentile</td>\n<td>190</td>\n<td>196</td>\n<td>216</td>\n<td>197</td>\n</tr>\n<tr>\n<td class='rowlabel'>90th percentile</td>\n<td>198</td>\n<td>205</td>\n<td>228</td>\n<td>221</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>1 (0.7%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (0.8%)</td>\n<td class='lastrow'>2 (0.6%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Body Mass (g)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>10th percentile</td>\n<td>3150</td>\n<td>3300</td>\n<td>4400</td>\n<td>3300</td>\n</tr>\n<tr>\n<td class='rowlabel'>50th percentile</td>\n<td>3700</td>\n<td>3700</td>\n<td>5000</td>\n<td>4050</td>\n</tr>\n<tr>\n<td class='rowlabel'>90th percentile</td>\n<td>4300</td>\n<td>4200</td>\n<td>5700</td>\n<td>5400</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>1 (0.7%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (0.8%)</td>\n<td class='lastrow'>2 (0.6%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Sex</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>female</td>\n<td>73 (48.0%)</td>\n<td>34 (50.0%)</td>\n<td>58 (46.8%)</td>\n<td>165 (48.0%)</td>\n</tr>\n<tr>\n<td class='rowlabel'>male</td>\n<td>73 (48.0%)</td>\n<td>34 (50.0%)</td>\n<td>61 (49.2%)</td>\n<td>168 (48.8%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>6 (3.9%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>5 (4.0%)</td>\n<td class='lastrow'>11 (3.2%)</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n\n\n<br>\n\nVery handy. \n\n\n### Supported aliases\n\nThe natural question you might have as the user of the package is, of course, what abbreviated codes does the table1 package understand? As documented [here](https://benjaminrich.github.io/table1/vignettes/table1-examples.html#using-abbreviated-code-to-specify-a-custom-renderer) in the package vignette, you can find a complete listing by playing around with the `stats.default()` function.^[If you're a foolish person like I am you can also dig into the [source code](https://github.com/benjaminrich/table1/blob/master/R/table1.R) to find the answer, because why would I be smart and read the package vignette *before* reading the source code?] So let's do that. For continuous variables, this is the list of supported aliases:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncontinuous <- 1:10\nnames(stats.default(continuous)) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"N\"      \"NMISS\"  \"SUM\"    \"MEAN\"   \"SD\"     \"CV\"     \"GMEAN\"  \"GSD\"    \"GCV\"   \n[10] \"MEDIAN\" \"MIN\"    \"MAX\"    \"q01\"    \"q02.5\"  \"q05\"    \"q10\"    \"q25\"    \"q50\"   \n[19] \"q75\"    \"q90\"    \"q95\"    \"q97.5\"  \"q99\"    \"Q1\"     \"Q2\"     \"Q3\"     \"IQR\"   \n[28] \"T1\"     \"T2\"    \n```\n\n\n:::\n:::\n\n\nHere's what each of these mean:^[If you want a more precise answer, you can use a command like `parse.abbrev.render.code(\"GMEAN\")` to return the actual function that is executed whenever a `\"GMEAN\"` is computed during the table rendering process.]\n\n- `\"N\"`, `\"NMISS\"`: these compute the number of non-missing observations and number of missing observations respectively\n- `\"SUM\"`, `\"MEAN\"`, `\"SD\"`, `\"MEDIAN\"`, `\"MIN\"`, `\"MAX\"`: these all correspond to to the functions of the same name, e.g., `\"SUM\"` produces a call to `sum()`, with missing values removed\n- `\"CV\"`: the coefficient of variation, i.e., 100 times the standard deviation divided by the absolute value of the mean\n- `\"GMEAN\"`, `\"GSD\"`, `\"GCV\"`: the geometric mean, geometric standard deviation, and geometric coefficient of variation\n- `q01`, `q02.5`, `\"q05\"`, `\"q10\"`, `\"q25\"`, `\"q50\"`, `\"q75\"`, `\"q90\"`, `\"q95\"`, `\"q97.5\"`, `\"q99\"`: these are understood to refer to specific quantiles, e.g., `\"q25\"` is translated as a function call that computes the 25th percentile\n- `\"Q1\"`, `\"Q2\"` `\"Q3\"`: these are used to compute quartiles (25th, 50th, and 75th percentiles)\n- `\"T1\"`, `\"T2\"`: these are used to compute tertiles (33rd and 67th percentiles)\n- `\"IQR\"`: this computes the interquartile range\n\nIn all cases except for `\"NMISS\"`, the relevant statistics are computed after removing missing values. Turning now to categorical variables, we can again use the `stats.default()` function to find the supported abbreviated codes:^[If you're curious as to why I'm extracting the first element of the output in this code, try playing around with `stats.default()` and looking at the differences between how the output is structured for continuous versus categorical inputs.]\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncategorical <- c(\"a\", \"b\", \"c\")\nnames(stats.default(categorical)[[1]])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"FREQ\"    \"PCT\"     \"PCTnoNA\" \"NMISS\"  \n```\n\n\n:::\n:::\n\n\nThe interpretation of these is as follows:\n\n- `\"FREQ\"`: the frequency count for a category\n- `\"PCT\"`: the percent relative frequency, with missing values included in the denominator\n- `\"PCTnoNA\"`: the percent relative frequency, after missing values are removed\n- `\"NMISS\"`: the number of missing values, as before\n\nThe nice thing about these abbreviated codes is that they cover a surprisingly wide variety of use cases. More often than not I've found that the descriptive statistics I need can be specified using this mechanism. From the analyst perspective this is great: you really don't want to waste time writing more code than you have to, so if you can specify your table of descriptive statistics without bothering to write a function, you're doing well.\n\n![](hit-me-like-a-man.jpg)\n\n### Writing render functions\n\n> I am strong, love is evil <br>\n> It's a version of perversion that is only for the lucky people <br>\n> Take your time and do with me what you will <br>\n> I won't mind, you know I'm ill, you know I'm ill <br>\n> So hit me like a man <br>\n> And love me like a woman <br>\n> &nbsp; &nbsp; -- *[The Pretty Reckless](https://www.youtube.com/watch?v=Z6ZtYZiHong)*\n\nAlas life is not always kind to us, and it's not uncommon to run into situations where your table of descriptive statistics requires the computation of something that doesn't have an abbreviated code in table1. When that happens, the only recourse is for the user to write a rendering function that takes the data as input and returns a vector of strings to be printed into the table. As an example, suppose you have a need to report [Winsorised](https://en.wikipedia.org/wiki/Winsorizing) summary statistics for your continuous variables:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrender_winsorized <- function(x, cutoff = .05, ...) {\n  lo <- quantile(x, cutoff, na.rm = TRUE)\n  hi <- quantile(x, 1 - cutoff, na.rm = TRUE)\n  x[x < lo] <- lo\n  x[x > hi] <- hi\n  strs <- c(\n    \"\",\n    \"Winsorized mean\" = sprintf(\"%1.2f\", mean(x, na.rm = TRUE)),\n    \"Winsorized SD\" = sprintf(\"%1.2f\", sd(x, na.rm = TRUE))\n  )\n  return(strs)\n}\n```\n:::\n\n\nNotice that this `render_winsorized()` function returns a named vector of strings that follows the same convention that we followed with the simpler `render_geometric` example earlier: the names of the output string become the row labels, and the values are printed into the table itself. Along similar lines, we can define a rendering function to be applied to the categorical variables in the data. Here's a very simple one that reports only the absolute frequencies for each category:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrender_counts <- function(x, ...) c(\"\", table(stringr::str_to_title(x)))\n```\n:::\n\n\nHaving defined our render functions, we produce the desired table by passing `render_winsorized()` as the handler for continuous variables and `render_counts()` as the handler for categorical variables:\n\n\n\n```{.r .cell-code}\ntable1(\n  x = ~ flipper_length_mm + body_mass_g + sex | species, \n  data = penguins, \n  render.continuous = render_winsorized,\n  render.categorical = render_counts\n)\n```\n\n```{=html}\n<div class=\"Rtable1\"><table class=\"Rtable1\">\n<thead>\n<tr>\n<th class='rowlabel firstrow lastrow'></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Adelie<br><span class='stratn'>(N=152)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Chinstrap<br><span class='stratn'>(N=68)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gentoo<br><span class='stratn'>(N=124)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Overall<br><span class='stratn'>(N=344)</span></span></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow'>Flipper Length (mm)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Winsorized mean</td>\n<td>189.91</td>\n<td>195.99</td>\n<td>217.23</td>\n<td>200.85</td>\n</tr>\n<tr>\n<td class='rowlabel'>Winsorized SD</td>\n<td>5.75</td>\n<td>6.43</td>\n<td>6.38</td>\n<td>13.52</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>1 (0.7%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (0.8%)</td>\n<td class='lastrow'>2 (0.6%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Body Mass (g)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Winsorized mean</td>\n<td>3696.52</td>\n<td>3738.68</td>\n<td>5074.80</td>\n<td>4200.80</td>\n</tr>\n<tr>\n<td class='rowlabel'>Winsorized SD</td>\n<td>432.98</td>\n<td>336.76</td>\n<td>471.74</td>\n<td>765.82</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>1 (0.7%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (0.8%)</td>\n<td class='lastrow'>2 (0.6%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Sex</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Female</td>\n<td>73</td>\n<td>34</td>\n<td>58</td>\n<td>165</td>\n</tr>\n<tr>\n<td class='rowlabel'>Male</td>\n<td>73</td>\n<td>34</td>\n<td>61</td>\n<td>168</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>6 (3.9%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>5 (4.0%)</td>\n<td class='lastrow'>11 (3.2%)</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n\n\n<br>\n\nOur table is mostly done, but we still don't have a method for adjusting how the missing data summaries are produced. To do that we need to define one more rendering function and pass it as the `render.missing` argument:\n\n\n\n```{.r .cell-code}\nrender_missing <- function(x, ...) c(\"Missing\" = sum(is.na(x)))\n\ntable1(\n  x = ~ flipper_length_mm + body_mass_g + sex | species, \n  data = penguins, \n  render.continuous = render_winsorized,\n  render.categorical = render_counts,\n  render.missing = render_missing\n)\n```\n\n```{=html}\n<div class=\"Rtable1\"><table class=\"Rtable1\">\n<thead>\n<tr>\n<th class='rowlabel firstrow lastrow'></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Adelie<br><span class='stratn'>(N=152)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Chinstrap<br><span class='stratn'>(N=68)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gentoo<br><span class='stratn'>(N=124)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Overall<br><span class='stratn'>(N=344)</span></span></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow'>Flipper Length (mm)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Winsorized mean</td>\n<td>189.91</td>\n<td>195.99</td>\n<td>217.23</td>\n<td>200.85</td>\n</tr>\n<tr>\n<td class='rowlabel'>Winsorized SD</td>\n<td>5.75</td>\n<td>6.43</td>\n<td>6.38</td>\n<td>13.52</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>1</td>\n<td class='lastrow'>0</td>\n<td class='lastrow'>1</td>\n<td class='lastrow'>2</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Body Mass (g)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Winsorized mean</td>\n<td>3696.52</td>\n<td>3738.68</td>\n<td>5074.80</td>\n<td>4200.80</td>\n</tr>\n<tr>\n<td class='rowlabel'>Winsorized SD</td>\n<td>432.98</td>\n<td>336.76</td>\n<td>471.74</td>\n<td>765.82</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>1</td>\n<td class='lastrow'>0</td>\n<td class='lastrow'>1</td>\n<td class='lastrow'>2</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Sex</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Female</td>\n<td>73</td>\n<td>34</td>\n<td>58</td>\n<td>165</td>\n</tr>\n<tr>\n<td class='rowlabel'>Male</td>\n<td>73</td>\n<td>34</td>\n<td>61</td>\n<td>168</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>6</td>\n<td class='lastrow'>0</td>\n<td class='lastrow'>5</td>\n<td class='lastrow'>11</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n\n\n<br>\n\n### Unpacking render functions\n\nThere's still a bit of a mystery here, because the `table1()` function doesn't have arguments `render.continuous`, `render.categorical`, or `render.missing`: instead, it has a `render` argument. What's actually going on here is that the default value for `render` is the `render.default()` function exported by table1, and `render.default()` accepts `render.continuous`, `render.categorical`, or `render.missing` as arguments. In other words, what's happening in the code above is that my custom functions end up being passed to `render.default()` via the dots. \n\nThere's nothing to prevent you from bypassing this whole process by writing your own render function that handles *all* the input variables. For example, here's a very simple rendering function that counts the number of non-missing observations, and prints it in the same row as the variable name:\n\n\n\n```{.r .cell-code}\nrender_n <- function(x, ...) sum(!is.na(x))\n\ntable1(\n  x = ~ flipper_length_mm + body_mass_g + sex | species, \n  data = penguins, \n  render = render_n\n)\n```\n\n```{=html}\n<div class=\"Rtable1\"><table class=\"Rtable1\">\n<thead>\n<tr>\n<th class='rowlabel firstrow lastrow'></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Adelie<br><span class='stratn'>(N=152)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Chinstrap<br><span class='stratn'>(N=68)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gentoo<br><span class='stratn'>(N=124)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Overall<br><span class='stratn'>(N=344)</span></span></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow lastrow'>Flipper Length (mm)</td>\n<td class='firstrow lastrow'>151</td>\n<td class='firstrow lastrow'>68</td>\n<td class='firstrow lastrow'>123</td>\n<td class='firstrow lastrow'>342</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow lastrow'>Body Mass (g)</td>\n<td class='firstrow lastrow'>151</td>\n<td class='firstrow lastrow'>68</td>\n<td class='firstrow lastrow'>123</td>\n<td class='firstrow lastrow'>342</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow lastrow'>Sex</td>\n<td class='firstrow lastrow'>146</td>\n<td class='firstrow lastrow'>68</td>\n<td class='firstrow lastrow'>119</td>\n<td class='firstrow lastrow'>333</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n\n\n<br>\n\nI have to confess it took me waaaaay too long to realise that I could do this in table1. True, I don't often have a need to bypass the `render.default()` function, but there are definitely times when that's a handy little bit of functionality. Sigh. Sometimes I'm quite dense. \n\n![](follow-me-down.jpg)\n\n## Table annotations\n\n> Follow me down to the river <br>\n> Drink while the water is clean <br>\n> Follow me down to the river tonight <br>\n> I'll be down here on my knees <br>\n> &nbsp; &nbsp; --*[The Pretty Reckless](https://www.youtube.com/watch?v=vfwJ-SoYw4U)*\n\nTime to switch gears a little. In the previous section I talked about how to customise the statistics that are reported in the table cells. Implicit in this discussion is the fact that a custom render function allows you to customise the row labels associated with each statistic, in exactly the same way that variable labels allow you to customise the variable descriptions that appear in the leftmost column of the table. Taken together, these two mechanisms (render functions and variable labels) give the user a *lot* of control over what appears in the leftmost column of the table. But what about the header row? How do we customise that in table1?\n\n### Strata column labels\n\nTo start with, let's consider the columns that associated with a particular stratum. In the penguins tables I've been creating, the strata are defined by the `species` variable so are three columns that are associated with a specific stratum. By default `table1()` will add a description for each such column in the header row that contains the category name (e.g., \"Gentoo\") and the number of observations that belong to this category. But perhaps we don't want those sample size numbers? Maybe all we want is the category name. To customise how each stratum is labelled in the header row, the `table1()` function has an argument called `render.strat` that takes a function as its value. The strata rendering function takes three arguments: the `label` is the value in the data that defines that category (e.g., `\"Gentoo\"`), `n` is the number of observations that have been assigned to the category, and `transpose` is a logical variable indicating whether the table is transposed (more on that later). The output of the function is a string that specifies (as HTML) what should appear in the header row. To illustrate the idea, here's a very simple stratum rendering function that only prints the category label:\n\n\n\n```{.r .cell-code}\nrender_strat <- function(label, n, transpose = FALSE) {\n  sprintf(\"<span class='stratlabel'>%s</span>\", label)\n}\n```\n\n\nThe only subtlety to this `render_strat()` function is that it outputs some HTML that wraps the `label` in an HTML span tag and assigns it to a class that we can (and will) use later on to create some fancy styling using CSS. But I'm getting ahead of myself a little. For now, it's enough to note that `render_strat()` creates a very simple label that just prints out the category label. Here it is in action: \n\n\n\n```{.r .cell-code}\ntable1(\n  x = ~ flipper_length_mm + body_mass_g | species,\n  data = penguins,\n  render.strat = render_strat\n)\n```\n\n```{=html}\n<div class=\"Rtable1\"><table class=\"Rtable1\">\n<thead>\n<tr>\n<th class='rowlabel firstrow lastrow'></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Adelie</span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Chinstrap</span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gentoo</span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Overall</span></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow'>Flipper Length (mm)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>190 (6.54)</td>\n<td>196 (7.13)</td>\n<td>217 (6.48)</td>\n<td>201 (14.1)</td>\n</tr>\n<tr>\n<td class='rowlabel'>Median [Min, Max]</td>\n<td>190 [172, 210]</td>\n<td>196 [178, 212]</td>\n<td>216 [203, 231]</td>\n<td>197 [172, 231]</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>1 (0.7%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (0.8%)</td>\n<td class='lastrow'>2 (0.6%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Body Mass (g)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>3700 (459)</td>\n<td>3730 (384)</td>\n<td>5080 (504)</td>\n<td>4200 (802)</td>\n</tr>\n<tr>\n<td class='rowlabel'>Median [Min, Max]</td>\n<td>3700 [2850, 4780]</td>\n<td>3700 [2700, 4800]</td>\n<td>5000 [3950, 6300]</td>\n<td>4050 [2700, 6300]</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>1 (0.7%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (0.8%)</td>\n<td class='lastrow'>2 (0.6%)</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n\n\n<br>\n\nIndeed it performs as expected: the sample size annotations are gone and we now have very minimalistic labels for each of the three penguin species. So let's move along.\n\n### Other column labels\n\nThere are two other columns that typically appear in a table1 output object: on the left we have column that contains the row labels, and on the right we have a table that contains the descriptive statistics for the \"overall\" data set where we collapse across all strata. By default, the row label column on the left has no label and the aggregated column on the right uses that label \"Overall\". Both of these are customisable in the call to `table1()`, using the `overall` and `rowlabelhead` arguments. An example of this is illustrated below:\n\n\n\n```{.r .cell-code}\ntable1(\n  x = ~ flipper_length_mm + body_mass_g | species,\n  data = penguins,\n  overall = \"All Species\",\n  rowlabelhead = \"Measurement\"\n)\n```\n\n```{=html}\n<div class=\"Rtable1\"><table class=\"Rtable1\">\n<thead>\n<tr>\n<th class='rowlabel firstrow lastrow'>Measurement</th>\n<th class='firstrow lastrow'><span class='stratlabel'>Adelie<br><span class='stratn'>(N=152)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Chinstrap<br><span class='stratn'>(N=68)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gentoo<br><span class='stratn'>(N=124)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>All Species<br><span class='stratn'>(N=344)</span></span></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow'>Flipper Length (mm)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>190 (6.54)</td>\n<td>196 (7.13)</td>\n<td>217 (6.48)</td>\n<td>201 (14.1)</td>\n</tr>\n<tr>\n<td class='rowlabel'>Median [Min, Max]</td>\n<td>190 [172, 210]</td>\n<td>196 [178, 212]</td>\n<td>216 [203, 231]</td>\n<td>197 [172, 231]</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>1 (0.7%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (0.8%)</td>\n<td class='lastrow'>2 (0.6%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Body Mass (g)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>3700 (459)</td>\n<td>3730 (384)</td>\n<td>5080 (504)</td>\n<td>4200 (802)</td>\n</tr>\n<tr>\n<td class='rowlabel'>Median [Min, Max]</td>\n<td>3700 [2850, 4780]</td>\n<td>3700 [2700, 4800]</td>\n<td>5000 [3950, 6300]</td>\n<td>4050 [2700, 6300]</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>1 (0.7%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (0.8%)</td>\n<td class='lastrow'>2 (0.6%)</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n\n\n<br>\n\n### Footnotes and captions\n\nIn addition to allowing you to customise the header row, the table1 package also supports the addition of captions and footnotes. Shockingly, it turns out you can specify these with `table1()` by using the `caption` and `footnote` arguments. Both of these take a single string as their input, and you can use HTML tags here. For example, here's a footer that acknowledges the two packages I've relied on most in this post, specifying the package names in boldface:\n\n\n\n```{.r .cell-code}\ntable1(\n  x = ~ flipper_length_mm + body_mass_g | species,\n  data = penguins,\n  footnote = \"Created using <b>table1</b> and <b>palmerpenguins</b>\"\n)\n```\n\n```{=html}\n<div class=\"Rtable1\"><table class=\"Rtable1\">\n<thead>\n<tr>\n<th class='rowlabel firstrow lastrow'></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Adelie<br><span class='stratn'>(N=152)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Chinstrap<br><span class='stratn'>(N=68)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gentoo<br><span class='stratn'>(N=124)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Overall<br><span class='stratn'>(N=344)</span></span></th>\n</tr>\n<tfoot><tr><td colspan=\"5\" class=\"Rtable1-footnote\"><p>Created using <b>table1</b> and <b>palmerpenguins</b></p>\n</td></tr></tfoot>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow'>Flipper Length (mm)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>190 (6.54)</td>\n<td>196 (7.13)</td>\n<td>217 (6.48)</td>\n<td>201 (14.1)</td>\n</tr>\n<tr>\n<td class='rowlabel'>Median [Min, Max]</td>\n<td>190 [172, 210]</td>\n<td>196 [178, 212]</td>\n<td>216 [203, 231]</td>\n<td>197 [172, 231]</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>1 (0.7%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (0.8%)</td>\n<td class='lastrow'>2 (0.6%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Body Mass (g)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>3700 (459)</td>\n<td>3730 (384)</td>\n<td>5080 (504)</td>\n<td>4200 (802)</td>\n</tr>\n<tr>\n<td class='rowlabel'>Median [Min, Max]</td>\n<td>3700 [2850, 4780]</td>\n<td>3700 [2700, 4800]</td>\n<td>5000 [3950, 6300]</td>\n<td>4050 [2700, 6300]</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>1 (0.7%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (0.8%)</td>\n<td class='lastrow'>2 (0.6%)</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n\n\n<br>\n\nSpecifying captions is very similar. Here's a simple example:\n\n\n\n```{.r .cell-code}\ntable1(\n  x = ~ flipper_length_mm + body_mass_g | species,\n  data = penguins,\n  caption = \"Flipper length and body mass by species among the Palmer penguins\"\n)\n```\n\n```{=html}\n<div class=\"Rtable1\"><table class=\"Rtable1\"><caption>Flipper length and body mass by species among the Palmer penguins</caption>\n\n<thead>\n<tr>\n<th class='rowlabel firstrow lastrow'></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Adelie<br><span class='stratn'>(N=152)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Chinstrap<br><span class='stratn'>(N=68)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gentoo<br><span class='stratn'>(N=124)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Overall<br><span class='stratn'>(N=344)</span></span></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow'>Flipper Length (mm)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>190 (6.54)</td>\n<td>196 (7.13)</td>\n<td>217 (6.48)</td>\n<td>201 (14.1)</td>\n</tr>\n<tr>\n<td class='rowlabel'>Median [Min, Max]</td>\n<td>190 [172, 210]</td>\n<td>196 [178, 212]</td>\n<td>216 [203, 231]</td>\n<td>197 [172, 231]</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>1 (0.7%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (0.8%)</td>\n<td class='lastrow'>2 (0.6%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Body Mass (g)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>3700 (459)</td>\n<td>3730 (384)</td>\n<td>5080 (504)</td>\n<td>4200 (802)</td>\n</tr>\n<tr>\n<td class='rowlabel'>Median [Min, Max]</td>\n<td>3700 [2850, 4780]</td>\n<td>3700 [2700, 4800]</td>\n<td>5000 [3950, 6300]</td>\n<td>4050 [2700, 6300]</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>1 (0.7%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (0.8%)</td>\n<td class='lastrow'>2 (0.6%)</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n\n\n<br>\n\n## Table structure\n\nSo far we've discussed how to control what statistics are computed in the table, and in the process I've also talked about how to specify the row and columns labels that are associated with the various statistics. I've also talked about other marginalia associated with a table, which in table1 is really just the footnote and caption. What I haven't talked about yet is how to control the *structure* of the table that gets produced. For the most part, this structure is controlled by the formula that you use to specify the table. When I specify a table like this\n\n```r\n~ flipper_length_mm + body_mass_g | species\n```\n\nI will generally get a table that has one column for each unique value of `species` (the strata), and a block of rows associated with each of the variables (`flipper_length_mm` and `body_mass_g`) that supply the relevant descriptive statistics. By default we also get one additional \"overall\" column that collapses the strata and reports descriptive statistics for the entire data set. Most of the time this is exactly the structure we want, but not always. To that end, table1 allows you to customise the structure in various ways.\n\n### Removing \"overall\"\n\nThe simplest way to modify the table structure is to remove the \"overall\" column that collapses the strata. We can do this using the `overall` argument. In the last section I showed how to use this argument to change the label associated with this column by passing a string, but if instead we set `overall = FALSE`, that column will be removed entirely:\n\n\n\n```{.r .cell-code}\ntable1(\n  x = ~ flipper_length_mm + body_mass_g | species,\n  data = penguins,\n  overall = FALSE\n)\n```\n\n```{=html}\n<div class=\"Rtable1\"><table class=\"Rtable1\">\n<thead>\n<tr>\n<th class='rowlabel firstrow lastrow'></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Adelie<br><span class='stratn'>(N=152)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Chinstrap<br><span class='stratn'>(N=68)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gentoo<br><span class='stratn'>(N=124)</span></span></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow'>Flipper Length (mm)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>190 (6.54)</td>\n<td>196 (7.13)</td>\n<td>217 (6.48)</td>\n</tr>\n<tr>\n<td class='rowlabel'>Median [Min, Max]</td>\n<td>190 [172, 210]</td>\n<td>196 [178, 212]</td>\n<td>216 [203, 231]</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>1 (0.7%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (0.8%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Body Mass (g)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>3700 (459)</td>\n<td>3730 (384)</td>\n<td>5080 (504)</td>\n</tr>\n<tr>\n<td class='rowlabel'>Median [Min, Max]</td>\n<td>3700 [2850, 4780]</td>\n<td>3700 [2700, 4800]</td>\n<td>5000 [3950, 6300]</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>1 (0.7%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (0.8%)</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n\n\n<br>\n\n### Nested stratifications\n\nUp to this point in the post I've used only a single variable to define the strata in the table. At the start of the post I mentioned that you can drop the stratification entirely simply by specifying a one-sided formula like `~ flipper_length_mm + body_mass_g` that doesn't include anything on the right hand side of the `|` separator. But that's rarely of interest to us in real world data analysis. The thing we're more likely to want is a *nested* stratification, where we define strata based on all unique combinations of two variables. For example, let's suppose I wanted to compute descriptive statistics for each `species` of penguin, but for each species the statistics should be computed separately for each `island`. Happily, the table1 package supports this kind of two-level stratification. All I have to do is write `species * island` on the right hand side of the separator like so:\n\n\n\n```{.r .cell-code}\ntable1(\n  x = ~ flipper_length_mm + body_mass_g | species * island,\n  data = penguins,\n  overall = FALSE\n)\n```\n\n```{=html}\n<div class=\"Rtable1\"><table class=\"Rtable1\">\n<thead>\n<tr>\n<th class=\"grouplabel\"></th>\n<th colspan=\"3\" class=\"grouplabel\"><div>Adelie</div></th>\n<th colspan=\"1\" class=\"grouplabel\"><div>Chinstrap</div></th>\n<th colspan=\"1\" class=\"grouplabel\"><div>Gentoo</div></th>\n</tr>\n<tr>\n<th class='rowlabel firstrow lastrow'></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Biscoe<br><span class='stratn'>(N=44)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Dream<br><span class='stratn'>(N=56)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Torgersen<br><span class='stratn'>(N=52)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Dream<br><span class='stratn'>(N=68)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Biscoe<br><span class='stratn'>(N=124)</span></span></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow'>Flipper Length (mm)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>189 (6.73)</td>\n<td>190 (6.59)</td>\n<td>191 (6.23)</td>\n<td>196 (7.13)</td>\n<td>217 (6.48)</td>\n</tr>\n<tr>\n<td class='rowlabel'>Median [Min, Max]</td>\n<td>190 [172, 203]</td>\n<td>190 [178, 208]</td>\n<td>191 [176, 210]</td>\n<td>196 [178, 212]</td>\n<td>216 [203, 231]</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (1.9%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (0.8%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Body Mass (g)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>3710 (488)</td>\n<td>3690 (455)</td>\n<td>3710 (445)</td>\n<td>3730 (384)</td>\n<td>5080 (504)</td>\n</tr>\n<tr>\n<td class='rowlabel'>Median [Min, Max]</td>\n<td>3750 [2850, 4780]</td>\n<td>3580 [2900, 4650]</td>\n<td>3700 [2900, 4700]</td>\n<td>3700 [2700, 4800]</td>\n<td>5000 [3950, 6300]</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (1.9%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (0.8%)</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n\n\n<br>\n\nAs it happens, only the Adelie penguins appear on all three islands: the Chinstrap penguins appear only on Dream Island, and the Gentoo penguins appear only on Biscoe Island. So the table here contains three columns for the Adelie penguins, and only one each for the Chinstrap and Gentoo penguins. \n\nThere are some limitations to this functionality. You can't stratify by more than two variables, and the stratification variables cannot contain any missing values. Even so, the functionality is pretty handy, and it is sensitive to the order in which you specify the two stratification variables. If I write `island * species` rather than `species * island`, I get this table instead:\n\n\n\n```{.r .cell-code}\ntable1(\n  x = ~ flipper_length_mm + body_mass_g | island * species,\n  data = penguins,\n  overall = FALSE\n)\n```\n\n```{=html}\n<div class=\"Rtable1\"><table class=\"Rtable1\">\n<thead>\n<tr>\n<th class=\"grouplabel\"></th>\n<th colspan=\"2\" class=\"grouplabel\"><div>Biscoe</div></th>\n<th colspan=\"2\" class=\"grouplabel\"><div>Dream</div></th>\n<th colspan=\"1\" class=\"grouplabel\"><div>Torgersen</div></th>\n</tr>\n<tr>\n<th class='rowlabel firstrow lastrow'></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Adelie<br><span class='stratn'>(N=44)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gentoo<br><span class='stratn'>(N=124)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Adelie<br><span class='stratn'>(N=56)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Chinstrap<br><span class='stratn'>(N=68)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Adelie<br><span class='stratn'>(N=52)</span></span></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow'>Flipper Length (mm)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>189 (6.73)</td>\n<td>217 (6.48)</td>\n<td>190 (6.59)</td>\n<td>196 (7.13)</td>\n<td>191 (6.23)</td>\n</tr>\n<tr>\n<td class='rowlabel'>Median [Min, Max]</td>\n<td>190 [172, 203]</td>\n<td>216 [203, 231]</td>\n<td>190 [178, 208]</td>\n<td>196 [178, 212]</td>\n<td>191 [176, 210]</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (0.8%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (1.9%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Body Mass (g)</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Mean (SD)</td>\n<td>3710 (488)</td>\n<td>5080 (504)</td>\n<td>3690 (455)</td>\n<td>3730 (384)</td>\n<td>3710 (445)</td>\n</tr>\n<tr>\n<td class='rowlabel'>Median [Min, Max]</td>\n<td>3750 [2850, 4780]</td>\n<td>5000 [3950, 6300]</td>\n<td>3580 [2900, 4650]</td>\n<td>3700 [2700, 4800]</td>\n<td>3700 [2900, 4700]</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Missing</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (0.8%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>1 (1.9%)</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n\n\n<br>\n\nI've found this functionality useful many times in my everyday life. \n\n### Adding extra columns\n\nAnother kind of \"structural\" customisation that table1 allows is adding new columns. A common use case for this functionality is to add a column that reports a p-value associated with a particular row. For example, suppose what I wanted my table to do is run a one-way ANOVA for each of the continuous variables in the table, to test to see if the categories have different group means. To handle something like this we'll again need to write a custom render function that accepts data from *all* groups -- as a list of vectors -- and returns a string that should be printed into the relevant cell in the new \"p-values\" column. This `render_p_value()` function will do this for me:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrender_p_value <- function(x, ...) {\n  dat <- bind_rows(\n    purrr::map(x, ~ data.frame(value = .)), \n    .id = \"group\"\n  )\n  mod <- aov(value ~ group, dat)\n  p <- summary(mod)[[1]][1, 5]\n  return(scales::label_pvalue()(p))\n}\n```\n:::\n\n\nI don't want to dive into the details of what this function is doing, but if you're familiar with the standard interface for linear models in R it should look very familiar. If not, here's the gist: the first part of the code rearranges the list of vectors input into a data frame format, the second part estimates parameters for the model, runs the usual F-test, and extracts the p-value from the output. Finally, it returns the p-value as a prettily-formatted string.\n\nThe `render_p_value()` function is the one we'll use to render our new column, but for the purposes of this example I'll also define a custom renderer for the contents of the strata columns as well, so that the only thing it does is report the mean value for the group. You don't have to do this, I'm only doing it because I want my table to be as simple as possible. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nrender_mean <- function(x, ...) sprintf(\"%1.1f\", mean(x, na.rm = TRUE))\n```\n:::\n\n\nNow that we have our rendering functions, I can specify one or more additional columns in my table by passing a named list of functions to the `extra.col` argument (the names are used to specify the column labels). In my case I'm only adding a single extra column with the p-value so my list has only a single function, but it's not too hard to imagine scenarios where I'd want to add more than one (e.g., maybe I want to report the degrees of freedom associated with my F-test). Anyway, here's the code:\n\n\n\n```{.r .cell-code}\ntable1(\n  x = ~ flipper_length_mm + body_mass_g | species,\n  data = penguins,\n  render = render_mean,\n  extra.col = list(\"p-value\" = render_p_value)\n)\n```\n\n```{=html}\n<div class=\"Rtable1\"><table class=\"Rtable1\">\n<thead>\n<tr>\n<th class='rowlabel firstrow lastrow'></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Adelie<br><span class='stratn'>(N=152)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Chinstrap<br><span class='stratn'>(N=68)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gentoo<br><span class='stratn'>(N=124)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Overall<br><span class='stratn'>(N=344)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>p-value</span></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow lastrow'>Flipper Length (mm)</td>\n<td class='firstrow lastrow'>190.0</td>\n<td class='firstrow lastrow'>195.8</td>\n<td class='firstrow lastrow'>217.2</td>\n<td class='firstrow lastrow'>200.9</td>\n<td class='firstrow lastrow'><0.001</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow lastrow'>Body Mass (g)</td>\n<td class='firstrow lastrow'>3700.7</td>\n<td class='firstrow lastrow'>3733.1</td>\n<td class='firstrow lastrow'>5076.0</td>\n<td class='firstrow lastrow'>4201.8</td>\n<td class='firstrow lastrow'><0.001</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n\n\n<br>\n\nVery nice.\n\n### Transposing tables\n\n> Let me open up the discussion with <br>\n> I'm not impressed with any motherfucking word I say <br>\n> See I lied that I cried when he came inside <br>\n> And now I'm burning a highway to Hades <br>\n> &nbsp; &nbsp; --*[The Pretty Reckless](https://www.youtube.com/watch?v=j6t-AgLT-LM&rco=1)*\n\nBefore I dive a little deeper and talk about table structures that go beyond what you can do with the formula interface to `table1()` there's one more thing I should talk about. I don't actually *want* to talk about this topic because it makes me cry a little bit every time I encounter it, but I'll be good and try anyway. \n\nThat topic is transposing a table. \n\nNormally when you specify a table with a formula, the stratification is used to create the columns, and the variable list is used to define the rows. You can flip this if you like by setting `transpose = TRUE` when calling `table1()`, but in my experience this is a bit messy and often requires a lot of tinkering with your render functions to make the results look good. To that end, here's a simple rendering function that I'll use in this example. All it does is compute the mean and standard deviation for a continuous variable:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrender_mean_sd <- function(x, ...) {\n  m <- mean(x, na.rm = TRUE)\n  s <- sd(x, na.rm = TRUE)\n  sprintf(\"%1.1f (%1.1f)\", m, s)\n}\n```\n:::\n\n\nWith the help of this `render_mean_sd()` function and the simple `render_strat()` function I defined earlier, here's an example of a transposed table in which the stratification variable (`species`) defines the rows, and the four variables on the left are used to define columns:\n\n\n\n```{.r .cell-code}\ntable1(\n  x = ~ bill_length_mm + bill_depth_mm + flipper_length_mm + body_mass_g | species,\n  data = penguins,\n  transpose = TRUE,\n  rowlabelhead = \"Species\",\n  render = render_mean_sd,\n  render.strat = render_strat\n)\n```\n\n```{=html}\n<div class=\"Rtable1\"><table class=\"Rtable1\">\n<thead>\n<tr>\n<th class='rowlabel firstrow lastrow'>Species</th>\n<th class='firstrow lastrow'>Bill Length (mm)</th>\n<th class='firstrow lastrow'>Bill Depth (mm)</th>\n<th class='firstrow lastrow'>Flipper Length (mm)</th>\n<th class='firstrow lastrow'>Body Mass (g)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow lastrow'><span class='stratlabel'>Adelie</span></td>\n<td class='firstrow lastrow'>38.8 (2.7)</td>\n<td class='firstrow lastrow'>18.3 (1.2)</td>\n<td class='firstrow lastrow'>190.0 (6.5)</td>\n<td class='firstrow lastrow'>3700.7 (458.6)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow lastrow'><span class='stratlabel'>Chinstrap</span></td>\n<td class='firstrow lastrow'>48.8 (3.3)</td>\n<td class='firstrow lastrow'>18.4 (1.1)</td>\n<td class='firstrow lastrow'>195.8 (7.1)</td>\n<td class='firstrow lastrow'>3733.1 (384.3)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow lastrow'><span class='stratlabel'>Gentoo</span></td>\n<td class='firstrow lastrow'>47.5 (3.1)</td>\n<td class='firstrow lastrow'>15.0 (1.0)</td>\n<td class='firstrow lastrow'>217.2 (6.5)</td>\n<td class='firstrow lastrow'>5076.0 (504.1)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow lastrow'><span class='stratlabel'>Overall</span></td>\n<td class='firstrow lastrow'>43.9 (5.5)</td>\n<td class='firstrow lastrow'>17.2 (2.0)</td>\n<td class='firstrow lastrow'>200.9 (14.1)</td>\n<td class='firstrow lastrow'>4201.8 (802.0)</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n\n\n<br>\n\nIt works, and there are definitely use cases for this. But the functionality is limited. It only works for a single stratification level (i.e., you can't do `species * island` in this context), and it only looks pretty because my `render_mean_sd()` function doesn't contain any labels. Things get messy pretty fast when working with transposed tables, and in all honesty I've never been willing to use this functionality in a client project.\n\n### Arbitrary stratification\n\n> Why'd you bring a shotgun to the party? <br>\n> &nbsp; &nbsp; --[*The Pretty Reckless*](https://www.youtube.com/watch?v=PYxd8gh7g_k)\n\nUp to this point in the post every table I've created with `table1()` has used a formula to specify the basic structure of the output. In real life this is almost always what you want to do, because this \"formula interface\" is pretty flexible and *extremely* easy to work with. I'd even go so far as to say that this formula interface is one of the most appealing aspects to the table1 package. However, in point of fact the formula interface that everyone uses is actually a bit of sweet syntactic sugar laid atop a lower-level interface. Very occasionally you encounter a situation where the formula interface isn't expressive enough to do what you want, and when that happens you have to \"bring a shotgun to the party\" and use the low level interface which takes a list of data frames (one per stratum) as input.\n\nTo motivate the discussion, I'll give an example of something that I've occasionally wanted to do but isn't possible with the formula interface. Earlier in this post I showed you how to create a *nested* stratification where we pass two stratification variables in the formula, and the table contains one stratum for every unique combination of the two variables. Sometimes, though, you want to create a table that stratifies by two variables but only shows the *marginal* stratifications. For example, I might want a table that includes descriptive statistics for each `species` of penguin, and next to that my table would have descriptive statistics for each `sex`. In this situation I'm not interested in the cross-tabulation. That is, I don't care about which species a male penguin belongs to, and I don't care about the sex of the various Adelie penguins either. I'm interested in `species` and `sex` completely independently of each other. The formula interface doesn't support this kind of stratification, so I'm going to have to do it manually. \n\nLet's see how this is done. First, I'm going to make a few tweaks to the data that aren't really very important, but will make my table a little nicer. Specifically, I'll convert the `sex` variable to title case so that I get nice labels later, and I'll convert `year` to a factor so that `table1()` treats it as a categorical variable:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins <- penguins |>\n  mutate(\n    sex = stringr::str_to_title(sex),\n    year = factor(year)\n  )\n```\n:::\n\n\nNow let's move along to the important step. I'm going to create a new variable called `penguins_strata` that is a list of data frames. \n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins_strata <- c(\n    split(penguins, ~species), \n    split(penguins, ~sex),\n    list(\"All\" = penguins)\n  )\n\npenguins_strata\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$Adelie\n# A tibble: 152 × 8\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex   \n   <fct>   <fct>              <dbl>         <dbl>             <int>       <int> <chr> \n 1 Adelie  Torgersen           39.1          18.7               181        3750 Male  \n 2 Adelie  Torgersen           39.5          17.4               186        3800 Female\n 3 Adelie  Torgersen           40.3          18                 195        3250 Female\n 4 Adelie  Torgersen           NA            NA                  NA          NA <NA>  \n 5 Adelie  Torgersen           36.7          19.3               193        3450 Female\n 6 Adelie  Torgersen           39.3          20.6               190        3650 Male  \n 7 Adelie  Torgersen           38.9          17.8               181        3625 Female\n 8 Adelie  Torgersen           39.2          19.6               195        4675 Male  \n 9 Adelie  Torgersen           34.1          18.1               193        3475 <NA>  \n10 Adelie  Torgersen           42            20.2               190        4250 <NA>  \n# ℹ 142 more rows\n# ℹ 1 more variable: year <fct>\n\n$Chinstrap\n# A tibble: 68 × 8\n   species   island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex   \n   <fct>     <fct>           <dbl>         <dbl>             <int>       <int> <chr> \n 1 Chinstrap Dream            46.5          17.9               192        3500 Female\n 2 Chinstrap Dream            50            19.5               196        3900 Male  \n 3 Chinstrap Dream            51.3          19.2               193        3650 Male  \n 4 Chinstrap Dream            45.4          18.7               188        3525 Female\n 5 Chinstrap Dream            52.7          19.8               197        3725 Male  \n 6 Chinstrap Dream            45.2          17.8               198        3950 Female\n 7 Chinstrap Dream            46.1          18.2               178        3250 Female\n 8 Chinstrap Dream            51.3          18.2               197        3750 Male  \n 9 Chinstrap Dream            46            18.9               195        4150 Female\n10 Chinstrap Dream            51.3          19.9               198        3700 Male  \n# ℹ 58 more rows\n# ℹ 1 more variable: year <fct>\n\n$Gentoo\n# A tibble: 124 × 8\n   species island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex   \n   <fct>   <fct>           <dbl>         <dbl>             <int>       <int> <chr> \n 1 Gentoo  Biscoe           46.1          13.2               211        4500 Female\n 2 Gentoo  Biscoe           50            16.3               230        5700 Male  \n 3 Gentoo  Biscoe           48.7          14.1               210        4450 Female\n 4 Gentoo  Biscoe           50            15.2               218        5700 Male  \n 5 Gentoo  Biscoe           47.6          14.5               215        5400 Male  \n 6 Gentoo  Biscoe           46.5          13.5               210        4550 Female\n 7 Gentoo  Biscoe           45.4          14.6               211        4800 Female\n 8 Gentoo  Biscoe           46.7          15.3               219        5200 Male  \n 9 Gentoo  Biscoe           43.3          13.4               209        4400 Female\n10 Gentoo  Biscoe           46.8          15.4               215        5150 Male  \n# ℹ 114 more rows\n# ℹ 1 more variable: year <fct>\n\n$Female\n# A tibble: 165 × 8\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex   \n   <fct>   <fct>              <dbl>         <dbl>             <int>       <int> <chr> \n 1 Adelie  Torgersen           39.5          17.4               186        3800 Female\n 2 Adelie  Torgersen           40.3          18                 195        3250 Female\n 3 Adelie  Torgersen           36.7          19.3               193        3450 Female\n 4 Adelie  Torgersen           38.9          17.8               181        3625 Female\n 5 Adelie  Torgersen           41.1          17.6               182        3200 Female\n 6 Adelie  Torgersen           36.6          17.8               185        3700 Female\n 7 Adelie  Torgersen           38.7          19                 195        3450 Female\n 8 Adelie  Torgersen           34.4          18.4               184        3325 Female\n 9 Adelie  Biscoe              37.8          18.3               174        3400 Female\n10 Adelie  Biscoe              35.9          19.2               189        3800 Female\n# ℹ 155 more rows\n# ℹ 1 more variable: year <fct>\n\n$Male\n# A tibble: 168 × 8\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex  \n   <fct>   <fct>              <dbl>         <dbl>             <int>       <int> <chr>\n 1 Adelie  Torgersen           39.1          18.7               181        3750 Male \n 2 Adelie  Torgersen           39.3          20.6               190        3650 Male \n 3 Adelie  Torgersen           39.2          19.6               195        4675 Male \n 4 Adelie  Torgersen           38.6          21.2               191        3800 Male \n 5 Adelie  Torgersen           34.6          21.1               198        4400 Male \n 6 Adelie  Torgersen           42.5          20.7               197        4500 Male \n 7 Adelie  Torgersen           46            21.5               194        4200 Male \n 8 Adelie  Biscoe              37.7          18.7               180        3600 Male \n 9 Adelie  Biscoe              38.2          18.1               185        3950 Male \n10 Adelie  Biscoe              38.8          17.2               180        3800 Male \n# ℹ 158 more rows\n# ℹ 1 more variable: year <fct>\n\n$All\n# A tibble: 344 × 8\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex   \n   <fct>   <fct>              <dbl>         <dbl>             <int>       <int> <chr> \n 1 Adelie  Torgersen           39.1          18.7               181        3750 Male  \n 2 Adelie  Torgersen           39.5          17.4               186        3800 Female\n 3 Adelie  Torgersen           40.3          18                 195        3250 Female\n 4 Adelie  Torgersen           NA            NA                  NA          NA <NA>  \n 5 Adelie  Torgersen           36.7          19.3               193        3450 Female\n 6 Adelie  Torgersen           39.3          20.6               190        3650 Male  \n 7 Adelie  Torgersen           38.9          17.8               181        3625 Female\n 8 Adelie  Torgersen           39.2          19.6               195        4675 Male  \n 9 Adelie  Torgersen           34.1          18.1               193        3475 <NA>  \n10 Adelie  Torgersen           42            20.2               190        4250 <NA>  \n# ℹ 334 more rows\n# ℹ 1 more variable: year <fct>\n```\n\n\n:::\n:::\n\n\nAs you can see from this lengthy output, the `penguins_strata` variable is a list of six data frames. There are three data frames corresponding to each of the three `species`, two data frames corresponding to each unique `sex` category, and a final data frame that contains the entire data set. Later on when I construct the table, the `table1()` function will render each of these six data frames into a single column with the appropriate descriptive statistics.\n\nThe second input we need is a \"labels\" list that does two jobs:\n\n- Notice that so far I've defined my strata, but haven't specified the variables. The labels list has to do this. It specifies which `variables` should to be used when computing descriptive statistics. For the purposes of this example, I would like to tabulate the number of penguins (in each stratum) found on each `island` and the number of penguins observed in each `year`\n\n- In my head, the thing I want to do here is stratify the data separately by each `species` and by each `sex`. But the `penguins_strata` object doesn't say anything about this. It's just a flat list of six data frames. It doesn't \"know\" that three of these data frames refer to different species and two of them refer to different sexes. For that matter, it doesn't know that the last data frame isn't associated with a grouping variable either. So we'll also need to specify a list of `groups` that supplies the names of these grouping variables.\n\nIn other words, we need something like this:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins_labels <- list(\n    variables = list(\n      island = \"Island\", # names denote variables, values supply labels\n      year = \"Year\"\n    ), \n    groups = list(\"Species\", \"Sex\", \"\") # this is a list of labels only\n  )\n\npenguin_groups <- c(3, 2, 1) # first three data frames are group 1, etc\n```\n:::\n\n\nAt this point we have:\n\n- `penguins_strata`, a variable that contains all the data organised into a list with one data frame per strata\n- `penguins_labels`, a list that specifies the variables for which descriptive statistics are requested and the labels that should be assigned to variables and strata groups; and\n- `penguins_groups`, a vector that specifies how the strata columns should be grouped \n\nIt's quite a bit of setup work, but having done all the hard parts during the setup, the call to `table1()` is now very simple:\n\n\n\n```{.r .cell-code}\ntable1(penguins_strata, penguins_labels, groupspan = penguin_groups)\n```\n\n```{=html}\n<div class=\"Rtable1\"><table class=\"Rtable1\">\n<thead>\n<tr>\n<th class=\"grouplabel\"></th>\n<th colspan=\"3\" class=\"grouplabel\"><div>Species</div></th>\n<th colspan=\"2\" class=\"grouplabel\"><div>Sex</div></th>\n<th colspan=\"1\" class=\"grouplabel\"></th>\n</tr>\n<tr>\n<th class='rowlabel firstrow lastrow'></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Adelie<br><span class='stratn'>(N=152)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Chinstrap<br><span class='stratn'>(N=68)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gentoo<br><span class='stratn'>(N=124)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Female<br><span class='stratn'>(N=165)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Male<br><span class='stratn'>(N=168)</span></span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>All<br><span class='stratn'>(N=344)</span></span></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow'>Island</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>Biscoe</td>\n<td>44 (28.9%)</td>\n<td>0 (0%)</td>\n<td>124 (100%)</td>\n<td>80 (48.5%)</td>\n<td>83 (49.4%)</td>\n<td>168 (48.8%)</td>\n</tr>\n<tr>\n<td class='rowlabel'>Dream</td>\n<td>56 (36.8%)</td>\n<td>68 (100%)</td>\n<td>0 (0%)</td>\n<td>61 (37.0%)</td>\n<td>62 (36.9%)</td>\n<td>124 (36.0%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>Torgersen</td>\n<td class='lastrow'>52 (34.2%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>0 (0%)</td>\n<td class='lastrow'>24 (14.5%)</td>\n<td class='lastrow'>23 (13.7%)</td>\n<td class='lastrow'>52 (15.1%)</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow'>Year</td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n<td class='firstrow'></td>\n</tr>\n<tr>\n<td class='rowlabel'>2007</td>\n<td>50 (32.9%)</td>\n<td>26 (38.2%)</td>\n<td>34 (27.4%)</td>\n<td>51 (30.9%)</td>\n<td>52 (31.0%)</td>\n<td>110 (32.0%)</td>\n</tr>\n<tr>\n<td class='rowlabel'>2008</td>\n<td>50 (32.9%)</td>\n<td>18 (26.5%)</td>\n<td>46 (37.1%)</td>\n<td>56 (33.9%)</td>\n<td>57 (33.9%)</td>\n<td>114 (33.1%)</td>\n</tr>\n<tr>\n<td class='rowlabel lastrow'>2009</td>\n<td class='lastrow'>52 (34.2%)</td>\n<td class='lastrow'>24 (35.3%)</td>\n<td class='lastrow'>44 (35.5%)</td>\n<td class='lastrow'>58 (35.2%)</td>\n<td class='lastrow'>59 (35.1%)</td>\n<td class='lastrow'>120 (34.9%)</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n\n\n<br>\n\nAnd there it is. A table with two marginal stratifications and an overall column that provides descriptive statistics for two categorical variables. \n\n## Styling tables\n\nThe last topic I want to cover in this post is the visual styling of tables produced by `table1()`. In a moment I'll show you what a table1 object looks like under the hood, but the short version is that the table structure is specified using HTML, and the visual styling is performed with the help of CSS. Most of the time when you're using the table1 package you don't really have to think too much about this, because the package comes with a collection of built-in styles that are usually good enough for a data analyst to use, but sometimes you want to go a little further. So we should talk a little about styling. \n\n### Built-in styles\n\nLet's start with the built-in styles that come for free with the table1 package. As described in the package vignette, if you're not particularly interested in writing your own CSS code you have these options available to you:\n\n- `zebra`: alternating shaded and unshaded rows\n- `grid`: show all grid lines\n- `shade`: shade the header in gray\n- `times`: use a serif font\n- `center`: center all columns\n\nEach of these is associated with a CSS class that has the `Rtable1-` prefix, e.g., the `zebra` style corresponds to the `Rtable1-zebra` CSS class. You can have one of these classes applied to your table using the `topclass` argument. For instance, here's a \"zebra\" style table:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable1(\n  x = ~ flipper_length_mm + body_mass_g | species,\n  data = penguins,\n  topclass = \"Rtable1-zebra\",\n  render = render_mean,\n  render.strat = render_strat,\n  footnote = \"Source: palmerpenguins\"\n)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"Rtable1\"><table class=\"Rtable1-zebra\">\n<thead>\n<tr>\n<th class='rowlabel firstrow lastrow'></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Adelie</span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Chinstrap</span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gentoo</span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Overall</span></th>\n</tr>\n<tfoot><tr><td colspan=\"5\" class=\"Rtable1-footnote\"><p>Source: palmerpenguins</p>\n</td></tr></tfoot>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow lastrow'>Flipper Length (mm)</td>\n<td class='firstrow lastrow'>190.0</td>\n<td class='firstrow lastrow'>195.8</td>\n<td class='firstrow lastrow'>217.2</td>\n<td class='firstrow lastrow'>200.9</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow lastrow'>Body Mass (g)</td>\n<td class='firstrow lastrow'>3700.7</td>\n<td class='firstrow lastrow'>3733.1</td>\n<td class='firstrow lastrow'>5076.0</td>\n<td class='firstrow lastrow'>4201.8</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n\n:::\n:::\n\n\nBecause these built-in styles are all CSS classes, you can apply more than one to your table. For example, if I want a table with zebra-style stripes, a shaded header bar, and text in Times New Roman font, I can specify `topclass = \"Rtable1-zebra Rtable1-shade Rtable1-times\"` and get the desired result:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable1(\n  x = ~ flipper_length_mm + body_mass_g | species,\n  data = penguins,\n  topclass = \"Rtable1-zebra Rtable1-shade Rtable1-times\",\n  render = render_mean,\n  render.strat = render_strat,\n  footnote = \"Source: palmerpenguins\"\n)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"Rtable1\"><table class=\"Rtable1-zebra Rtable1-shade Rtable1-times\">\n<thead>\n<tr>\n<th class='rowlabel firstrow lastrow'></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Adelie</span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Chinstrap</span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gentoo</span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Overall</span></th>\n</tr>\n<tfoot><tr><td colspan=\"5\" class=\"Rtable1-footnote\"><p>Source: palmerpenguins</p>\n</td></tr></tfoot>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow lastrow'>Flipper Length (mm)</td>\n<td class='firstrow lastrow'>190.0</td>\n<td class='firstrow lastrow'>195.8</td>\n<td class='firstrow lastrow'>217.2</td>\n<td class='firstrow lastrow'>200.9</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow lastrow'>Body Mass (g)</td>\n<td class='firstrow lastrow'>3700.7</td>\n<td class='firstrow lastrow'>3733.1</td>\n<td class='firstrow lastrow'>5076.0</td>\n<td class='firstrow lastrow'>4201.8</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n### Using custom CSS\n\n> Signed with the devil <br>\n> Signed with the devil <br>\n> Signed with the devil, oh <br>\n> &nbsp; &nbsp; --*[The Pretty Reckless](https://www.youtube.com/watch?v=BQpZv2r8fb4)*\n\nIn everyday data analysis work the build-in style classes that come with the table1 package are good enough to create pretty outputs. But sometimes they are not. A client or a journal might want a table to be formatted in a very specific style, and at that point you're going to have to write your own CSS code. I have a love/hate relationship with CSS. It's such a powerful tool for styling HTML objects, but somehow it never feels natural to me and I feel like I'm making a pact with dark powers every time I use. Unfortunately I'm at the point in the post where I have to deal with demonic forces. Let's just hope we all come through this unscathed yeah?\n\nTo help with this disussion I'll start by creating a table, but instead of printing it to the output, I'll assign it to a variable called `tbl`. As you can see from the code below, I've specified `topclass = \"mytable\"` so that I can write some CSS that will be applied only to this table (or, I suppose, any other table that has CSS class `mytable`, but I'm only going to make one):\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntbl <- table1(\n  x = ~ flipper_length_mm + body_mass_g | species,\n  data = penguins,\n  topclass = \"mytable\",\n  render = render_mean,\n  render.strat = render_strat,\n  footnote = \"Source: palmerpenguins\"\n)\n```\n:::\n\n\nNext, if we want to write some CSS that will target this table, it helps a great deal to be able to see the actual HTML associated with the `tbl` object. Here it is:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncat(as.character(tbl))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n<table class=\"mytable\">\n<thead>\n<tr>\n<th class='rowlabel firstrow lastrow'></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Adelie</span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Chinstrap</span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gentoo</span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Overall</span></th>\n</tr>\n<tfoot><tr><td colspan=\"5\" class=\"Rtable1-footnote\"><p>Source: palmerpenguins</p>\n</td></tr></tfoot>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow lastrow'>Flipper Length (mm)</td>\n<td class='firstrow lastrow'>190.0</td>\n<td class='firstrow lastrow'>195.8</td>\n<td class='firstrow lastrow'>217.2</td>\n<td class='firstrow lastrow'>200.9</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow lastrow'>Body Mass (g)</td>\n<td class='firstrow lastrow'>3700.7</td>\n<td class='firstrow lastrow'>3733.1</td>\n<td class='firstrow lastrow'>5076.0</td>\n<td class='firstrow lastrow'>4201.8</td>\n</tr>\n</tbody>\n</table>\n```\n\n\n:::\n:::\n\n\nThis output reveals the CSS class names associated with the specific components of the table. So, let's suppose that the client has indicated that the table footnote needs to be in italics and -- for reasons known but to god -- the header text needs to be shown in hot pink. Thanks to the blood magic of CSS nesting, I can write a little snippet of CSS that specifies that for any table of CSS class `mytable`, the footnote should be in italics and the stratification labels should be shown in hot pink:\n\n```css\n.mytable {\n  .Rtable1-footnote {\n    font-style: italic;\n  }\n  .stratlabel {\n    color: hotpink\n  }\n}\n```\n\nUnder the hood, I have saved this exact CSS snippet to a tiny stylesheet that is imported within this post, so when I print out the `tbl` object I get the desired result:\n\n\n\n```{.r .cell-code}\ntbl\n```\n\n```{=html}\n<div class=\"Rtable1\"><table class=\"mytable\">\n<thead>\n<tr>\n<th class='rowlabel firstrow lastrow'></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Adelie</span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Chinstrap</span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Gentoo</span></th>\n<th class='firstrow lastrow'><span class='stratlabel'>Overall</span></th>\n</tr>\n<tfoot><tr><td colspan=\"5\" class=\"Rtable1-footnote\"><p>Source: palmerpenguins</p>\n</td></tr></tfoot>\n</thead>\n<tbody>\n<tr>\n<td class='rowlabel firstrow lastrow'>Flipper Length (mm)</td>\n<td class='firstrow lastrow'>190.0</td>\n<td class='firstrow lastrow'>195.8</td>\n<td class='firstrow lastrow'>217.2</td>\n<td class='firstrow lastrow'>200.9</td>\n</tr>\n<tr>\n<td class='rowlabel firstrow lastrow'>Body Mass (g)</td>\n<td class='firstrow lastrow'>3700.7</td>\n<td class='firstrow lastrow'>3733.1</td>\n<td class='firstrow lastrow'>5076.0</td>\n<td class='firstrow lastrow'>4201.8</td>\n</tr>\n</tbody>\n</table>\n</div>\n```\n\n\n<br>\n\nAnother day, another encounter with CSS that I have survived. I will take the victory. \n\n## Epilogue\n\nIn the process of writing this post I discovered that The Pretty Reckless have recorded a [cover](https://www.youtube.com/watch?v=PJ9Xy3RJoOA) of \"Champagne Supernova\" and I cannot stop laughing. It's good to laugh again.\n\n\n![](take-me-down.jpg)\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/table1-1.0/table1_defaults.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}